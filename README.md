# KuchikomiElevator

# ユーザー権限と機能アクセス

| ユーザー権限 | 利用者 | アクセス範囲 | ShopsController | ReviewsController |
|-------------|------------|------------|-----------------|-------------------|
| admin       | 開発者・運用者 | すべてのお店 | すべて            | すべて              |
| owner       | オーナー・店長・店員 | 特定のお店   | show, edit, update | すべて              |
| customer    | お店に来たお客さん | 特定のお店   | アクセス不可           | new, create, notice |


# DB
https://drawsql.app/teams/--109/diagrams/kuchikomi-elevator-2

# 設計方針
- enum
  - 権限
- アクティブハッシュ
  - 言語設定
- テーブル管理、縦持ち
  - 業界
- カラム追加、横持ち
  - お店名
- i18n
  - いろんなページの文言
- 定数
 
# AWS アーキテクチャ提案（コスト順）

## 1. 最小コスト構成
Route 53 → EC2 (t3.micro) [スポットインスタンス] → MySQL(EC2内) → S3
Copy- **月額コスト：約¥900（$6）**
- **主な用途：開発初期、MVP、小規模運用**
### 特徴
- EC2内にMySQLを直接インストール
- スポットインスタンスによるコスト削減
- シンプルな構成で管理が容易
### デメリット
- DBの冗長性なし
- スポットインスタンスは中断の可能性あり
- スケーリングは手動

→ S3にバックアップを取ることも可能

## 2. 標準構成（EC2 + RDS）
Route 53 → EC2 (t3.micro) → RDS (t3.micro) → S3
Copy- **月額コスト：約¥3,750（$25）**
- **主な用途：小～中規模のプロダクション環境**
### 特徴
- RDSによる堅牢なDB運用
- バックアップ・復元が容易
- 管理が比較的容易
### デメリット
- コストが中程度
- スケーリングは手動
- 運用管理の工数が必要

## 3. サーバーレス構成
Route 53 → API Gateway → Lambda → Aurora Serverless v2 → S3
Copy- **月額コスト：約¥6,150（$41）**
- **主な用途：変動の大きいワークロード、運用工数を最小化したい場合**
### 特徴
- サーバー管理不要
- 自動スケーリング
- 高可用性
### デメリット
- 最もコストが高い
- 初期構築が複雑
- コールドスタートの問題

## 選定の指針
1. **開発初期・検証フェーズ**
   - 最小コスト構成を推奨
   - コストを抑えながら機能検証が可能

2. **本番運用開始時**
   - 標準構成への移行を検討
   - データの永続性と運用の安定性を確保

3. **スケール時・運用効率化時**
   - サーバーレス構成への移行を検討
   - トラフィック変動への対応と運用負荷の軽減

## 注意点
- すべての構成で、AWS無料枠の活用が可能
- トラフィック増加に応じて、上位構成への移行を検討
- セキュリティとバックアップは全構成で考慮が必要
